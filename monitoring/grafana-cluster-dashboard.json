{
  "annotations": { "list": [] },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "panels": [
    {
      "title": "Cluster Overview",
      "type": "row",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 },
      "collapsed": false
    },
    {
      "title": "Brokers Online",
      "type": "stat",
      "gridPos": { "h": 4, "w": 4, "x": 0, "y": 1 },
      "targets": [{ "expr": "count(up{job=\"streamline\"} == 1)", "legendFormat": "" }],
      "fieldConfig": { "defaults": { "thresholds": { "steps": [{"color": "red", "value": null}, {"color": "green", "value": 1}] } } }
    },
    {
      "title": "Total Topics",
      "type": "stat",
      "gridPos": { "h": 4, "w": 4, "x": 4, "y": 1 },
      "targets": [{ "expr": "streamline_topics_total", "legendFormat": "" }]
    },
    {
      "title": "Messages/sec",
      "type": "stat",
      "gridPos": { "h": 4, "w": 4, "x": 8, "y": 1 },
      "targets": [{ "expr": "sum(rate(streamline_messages_produced_total[5m]))", "legendFormat": "" }],
      "fieldConfig": { "defaults": { "unit": "ops" } }
    },
    {
      "title": "Bytes In/sec",
      "type": "stat",
      "gridPos": { "h": 4, "w": 4, "x": 12, "y": 1 },
      "targets": [{ "expr": "sum(rate(streamline_bytes_received_total[5m]))", "legendFormat": "" }],
      "fieldConfig": { "defaults": { "unit": "Bps" } }
    },
    {
      "title": "Bytes Out/sec",
      "type": "stat",
      "gridPos": { "h": 4, "w": 4, "x": 16, "y": 1 },
      "targets": [{ "expr": "sum(rate(streamline_bytes_sent_total[5m]))", "legendFormat": "" }],
      "fieldConfig": { "defaults": { "unit": "Bps" } }
    },
    {
      "title": "Cluster Leader",
      "type": "stat",
      "gridPos": { "h": 4, "w": 4, "x": 20, "y": 1 },
      "targets": [{ "expr": "streamline_cluster_leader_id", "legendFormat": "" }]
    },
    {
      "title": "Throughput",
      "type": "row",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 5 },
      "collapsed": false
    },
    {
      "title": "Produce Throughput (per broker)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 6 },
      "targets": [{ "expr": "rate(streamline_messages_produced_total[5m])", "legendFormat": "{{instance}}" }],
      "fieldConfig": { "defaults": { "unit": "ops" } }
    },
    {
      "title": "Fetch Throughput (per broker)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 6 },
      "targets": [{ "expr": "rate(streamline_messages_consumed_total[5m])", "legendFormat": "{{instance}}" }],
      "fieldConfig": { "defaults": { "unit": "ops" } }
    },
    {
      "title": "Latency",
      "type": "row",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 14 },
      "collapsed": false
    },
    {
      "title": "Produce Latency (p50/p95/p99)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 15 },
      "targets": [
        { "expr": "histogram_quantile(0.50, rate(streamline_produce_duration_seconds_bucket[5m]))", "legendFormat": "p50" },
        { "expr": "histogram_quantile(0.95, rate(streamline_produce_duration_seconds_bucket[5m]))", "legendFormat": "p95" },
        { "expr": "histogram_quantile(0.99, rate(streamline_produce_duration_seconds_bucket[5m]))", "legendFormat": "p99" }
      ],
      "fieldConfig": { "defaults": { "unit": "s" } }
    },
    {
      "title": "Fetch Latency (p50/p95/p99)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 15 },
      "targets": [
        { "expr": "histogram_quantile(0.50, rate(streamline_fetch_duration_seconds_bucket[5m]))", "legendFormat": "p50" },
        { "expr": "histogram_quantile(0.95, rate(streamline_fetch_duration_seconds_bucket[5m]))", "legendFormat": "p95" },
        { "expr": "histogram_quantile(0.99, rate(streamline_fetch_duration_seconds_bucket[5m]))", "legendFormat": "p99" }
      ],
      "fieldConfig": { "defaults": { "unit": "s" } }
    },
    {
      "title": "Storage & Replication",
      "type": "row",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 23 },
      "collapsed": false
    },
    {
      "title": "Disk Usage (per broker)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 8, "x": 0, "y": 24 },
      "targets": [{ "expr": "streamline_storage_bytes_total", "legendFormat": "{{instance}}" }],
      "fieldConfig": { "defaults": { "unit": "bytes" } }
    },
    {
      "title": "Partition Distribution",
      "type": "bargauge",
      "gridPos": { "h": 8, "w": 8, "x": 8, "y": 24 },
      "targets": [{ "expr": "streamline_partitions_total", "legendFormat": "{{instance}}" }]
    },
    {
      "title": "Under-Replicated Partitions",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 8, "x": 16, "y": 24 },
      "targets": [{ "expr": "streamline_under_replicated_partitions", "legendFormat": "{{instance}}" }],
      "fieldConfig": { "defaults": { "thresholds": { "steps": [{"color": "green", "value": null}, {"color": "red", "value": 1}] } } }
    },
    {
      "title": "Consumer Groups",
      "type": "row",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 32 },
      "collapsed": false
    },
    {
      "title": "Consumer Group Lag (top 10)",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 24, "x": 0, "y": 33 },
      "targets": [{ "expr": "topk(10, streamline_consumer_group_lag)", "legendFormat": "{{group}} / {{topic}}" }]
    },
    {
      "title": "Resources",
      "type": "row",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 41 },
      "collapsed": false
    },
    {
      "title": "CPU Usage",
      "type": "timeseries",
      "gridPos": { "h": 6, "w": 8, "x": 0, "y": 42 },
      "targets": [{ "expr": "rate(process_cpu_seconds_total{job=\"streamline\"}[5m])", "legendFormat": "{{instance}}" }]
    },
    {
      "title": "Memory Usage",
      "type": "timeseries",
      "gridPos": { "h": 6, "w": 8, "x": 8, "y": 42 },
      "targets": [{ "expr": "process_resident_memory_bytes{job=\"streamline\"}", "legendFormat": "{{instance}}" }],
      "fieldConfig": { "defaults": { "unit": "bytes" } }
    },
    {
      "title": "Active Connections",
      "type": "timeseries",
      "gridPos": { "h": 6, "w": 8, "x": 16, "y": 42 },
      "targets": [{ "expr": "streamline_connections_active", "legendFormat": "{{instance}}" }]
    }
  ],
  "schemaVersion": 39,
  "tags": ["streamline", "kafka", "streaming"],
  "templating": {
    "list": [
      {
        "name": "datasource",
        "type": "datasource",
        "query": "prometheus"
      }
    ]
  },
  "time": { "from": "now-1h", "to": "now" },
  "title": "Streamline Cluster Overview",
  "uid": "streamline-cluster",
  "version": 1
}
